#!/bin/sh

# usage: htmlindex [directory]
# generate index.html in directory for every file.
# also generate htmlindex.html which contains this script.

DIR=.; [ "$1" != "" ] && DIR=$1 && shift
gen=`basename $0 .sh`

cd $DIR

sed -e 's/</\<\;/g;s/>/\>\;/g' \
    -e '1s/^/<html><pre>/;$s,$,</pre></html>,' $0 > $gen.html

(
	echo '<html><p>Generated by <a href="'$gen.html'">'$gen.sh'</a></p><ul>'
	du -a | sed '$d' | awk '{$1="";print}' | while read f; do
		echo '<li><a href="'$f'">'$f'</a></li>'
	done
	echo '</ul></html>'
) > index.html
